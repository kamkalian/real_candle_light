#include <Adafruit_NeoPixel.h>

// Which pin on the Arduino is connected to the NeoPixels?
#define LED_PIN     1

// How many NeoPixels are attached to the Arduino?
#define LED_COUNT  2

// NeoPixel brightness, 0 (min) to 255 (max)
#define BRIGHTNESS 250

// Halloweenmode: set true and the LED will alternate warm white and green color
#define halloweenmode true

// Recorded values from real candle; count=2000
const int PROGMEM real_candle_values[] = {0,5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100,105,110,115,120,125,130,135,140,145,150,155,160,165,170,175,180,185,190,196,196,196,196,196,186,186,186,186,196,196,196,196,196,196,196,186,186,186,196,196,196,196,196,196,196,196,196,186,186,186,186,186,186,186,186,186,186,186,186,186,186,186,186,186,177,186,186,186,186,186,186,186,186,186,186,186,186,196,196,196,196,196,206,206,206,196,206,206,206,206,206,206,206,206,206,206,206,206,206,206,206,206,216,216,226,226,235,235,235,235,245,245,245,245,245,255,255,245,245,245,245,235,235,226,226,216,216,216,216,216,216,206,206,206,206,206,206,206,206,216,206,206,216,216,216,216,216,216,216,206,216,216,216,216,216,216,216,216,226,226,226,226,226,226,226,235,235,235,235,235,235,235,235,235,235,235,235,235,235,235,235,235,235,235,235,235,235,235,226,235,226,226,226,235,226,226,226,226,226,216,216,216,216,216,216,216,216,206,216,206,206,206,206,206,206,216,216,216,216,226,216,226,226,216,226,226,226,216,226,226,226,216,216,216,216,206,206,196,206,206,196,196,196,196,196,196,196,196,206,206,216,216,216,226,235,235,245,245,245,245,245,245,245,245,245,245,255,255,245,245,245,245,235,235,235,226,226,226,226,226,226,226,216,216,216,216,216,206,216,216,206,216,216,216,216,216,216,216,216,216,216,206,206,206,206,216,216,216,216,216,216,216,216,216,206,206,206,206,206,206,196,196,196,196,186,186,186,177,186,186,186,186,186,196,206,216,226,226,226,226,226,226,226,226,216,216,206,206,206,196,196,186,186,177,177,177,177,177,177,186,186,196,196,196,206,206,206,206,216,216,216,216,216,216,216,216,216,216,216,216,216,206,206,206,216,216,216,216,216,216,216,216,216,206,206,206,206,206,206,206,206,196,196,196,196,196,186,186,186,177,177,177,186,177,177,177,177,177,167,167,167,167,167,167,167,167,167,167,157,157,157,157,157,157,157,157,157,167,167,167,177,177,177,177,177,177,186,186,186,186,186,186,186,186,177,177,177,167,157,157,157,147,147,137,137,128,128,128,128,128,128,128,128,137,137,147,157,157,167,167,177,177,177,177,177,186,177,177,177,177,177,167,167,167,157,147,137,137,128,128,118,118,118,108,108,108,108,108,108,108,118,118,118,118,118,118,118,108,108,98,98,88,78,78,78,78,69,69,78,78,78,78,78,78,88,78,88,88,78,88,88,88,88,88,88,88,78,88,78,78,78,78,78,78,88,78,78,78,88,78,78,78,88,88,78,88,88,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,88,88,88,88,88,88,88,88,88,88,98,88,88,88,78,78,78,78,78,78,69,69,69,69,69,59,69,59,59,59,59,59,59,59,59,59,59,59,59,49,49,49,39,39,39,39,39,49,49,49,49,49,49,49,49,49,59,59,59,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,78,78,78,78,78,78,88,88,88,88,98,98,98,108,108,108,108,108,108,108,118,118,128,128,128,137,137,137,147,147,147,157,157,167,167,167,167,177,177,177,177,177,177,186,177,177,186,186,186,186,196,196,196,206,206,206,206,216,216,226,226,226,226,226,226,226,216,216,216,206,206,206,206,206,206,206,206,216,216,216,216,216,216,216,216,206,206,206,206,196,196,196,186,186,177,177,177,177,177,177,186,186,186,196,196,196,196,196,196,196,196,196,196,196,186,186,186,186,186,186,177,177,186,186,186,196,196,196,196,196,196,196,206,206,196,196,196,196,196,196,186,186,186,186,177,177,177,177,177,177,186,177,186,186,186,186,186,186,196,196,196,196,196,196,196,196,186,196,186,186,186,186,186,186,186,196,196,196,196,206,206,206,206,206,206,206,206,206,216,216,206,206,206,206,206,206,206,206,206,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,206,206,206,206,216,216,216,216,216,216,216,226,216,216,216,226,226,226,226,226,226,235,235,235,235,235,235,226,226,235,226,235,235,235,235,235,235,235,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,216,216,216,216,216,226,226,226,226,226,226,226,226,226,226,216,226,226,226,226,226,226,226,226,226,226,226,216,226,226,226,226,216,216,226,216,216,216,216,206,206,206,206,206,206,206,206,206,196,196,196,196,186,186,186,186,186,186,186,177,177,177,167,167,167,167,157,157,157,157,157,157,157,157,147,147,147,137,137,137,137,137,137,137,128,128,128,128,118,118,118,118,108,108,108,108,108,108,108,98,108,98,98,98,88,88,88,98,88,88,88,88,78,78,78,78,78,78,78,78,78,78,78,78,78,78,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,78,78,78,69,78,69,69,69,69,69,69,69,69,69,69,69,69,69,59,59,59,59,59,69,69,69,69,69,69,69,69,59,69,59,69,59,59,59,59,59,49,49,49,39,49,39,39,39,39,39,39,49,59,59,69,69,69,69,78,78,78,78,78,69,69,69,69,69,69,59,59,49,49,49,49,49,49,49,49,59,59,59,59,69,69,78,78,78,88,98,98,98,98,98,98,88,98,88,88,88,88,88,88,88,78,78,78,78,78,78,78,78,78,88,98,98,108,108,118,118,118,128,128,128,128,128,137,137,137,137,147,137,147,147,147,147,147,147,147,157,157,157,157,157,157,167,157,157,167,167,167,167,177,177,186,186,186,196,186,196,196,196,196,196,196,206,196,196,206,196,196,196,206,206,206,196,206,206,206,216,216,216,216,216,216,216,216,216,216,216,216,216,216,226,226,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,216,226,216,216,206,206,206,206,206,196,196,196,196,196,196,186,186,186,186,186,177,177,186,177,177,177,177,177,177,177,167,167,167,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,167,167,167,167,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,167,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,147,147,147,147,147,147,147,147,147,147,147,147,137,137,137,137,137,137,137,137,137,137,137,137,137,137,137,137,137,137,137,137,137,137,137,147,137,137,137,147,137,137,147,147,147,147,147,147,147,157,157,147,147,157,147,147,147,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,167,167,157,157,157,167,157,167,167,167,167,167,177,177,177,177,177,177,177,177,177,177,177,177,186,186,177,177,177,177,177,177,177,177,177,177,177,177,186,186,177,177,177,177,177,177,177,177,177,177,177,177,177,177,177,177,177,177,177,167,167,177,177,177,177,177,177,177,177,167,167,167,167,167,167,157,167,167,167,157,167,157,157,157,157,157,157,157,157,157,157,157,157,147,157,147,147,147,137,137,137,147,137,137,137,147,137,137,137,137,137,128,137,128,128,128,128,128,128,128,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,118,108,108,108,108,108,98,108,108,98,108,108,108,98,108,108,108,108,108,108,108,108,108,108,108,108,108,98,108,98,98,98,98,98,98,98,98,98,108,108,108,108,108,108,108,108,118,108,118,118,108,108,108,98,98,98,98,98,88,98,98,98,98,108,108,108,118,118,118,118,118,118,118,118,118,118,118,118,108,108,108,98,98,98,98,98,98,108,98,98,108,108,108,108,118,108,118,118,118,128,118,118,118,118,118,118,108,98,98,98,98,88,88,88,88,88,78,78,78,78,78,78,88,88,88,98,98,108,108,108,108,108,98,98,98,88,88,88,88,88,78,78,78,69,69,69,69,69,69,78,88,88,98,98,108,108,108,108,108,108,108,108,108,108,108,108,108,118,118,118,118,118,128,128,137,137,147,147,147,157,157,157,157,157,157,147,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,157,147,147,147,147,147,147,147,147,137,137,137,137,137,137,137,137,137,137,137,137,137,137,137,128,128,128,128,137,128,137,137,137,137,137,128,128,128,128,128,118,118,118,118,118,118,118,118,118,118,118,108,108,118,118,118,118,118,128,128,128,128,128,128,137,137,137,137,137,137,137,137,137,137,137,137,137,137,128,128,128,128,128,128,128,128,128,128,128,128,128,137,137,137,147,147,157,167,167,177,177,177,177,177,177,177,167,167,167,167,167,157,150,145,140,135,130,125,120,115,110,105,100,95,90,85,80,75,70,65,60,55,50,45,40,35,30,25,20,15,10,5,0};

// Position shows on the next index in real_candle_values and will increase in loop()
int pos = 0;

// Trigger for halloweenmode
bool green_on = false;

// Declare our NeoPixel strip object:
Adafruit_NeoPixel strip(LED_COUNT, LED_PIN, NEO_GRBW + NEO_KHZ800);


void setup() {
  strip.begin();           // INITIALIZE NeoPixel strip object (REQUIRED)
  strip.show();            // Turn OFF all pixels ASAP
  strip.setBrightness(BRIGHTNESS); // Set BRIGHTNESS 
}

void loop() {
  int value = pgm_read_word_near(real_candle_values + pos);
  for(int i=0; i<LED_COUNT; i++){
    if(!green_on){
      strip.setPixelColor(i, strip.Color(value, value/4, 0, value/20)); // color for orange-yellow candle
    }else{
      strip.setPixelColor(i, strip.Color(0, value, 0, value/20)); // color for green candle
    }
  }
  strip.show();
  delay(10); // Adds a delay between pulse sets
  pos++;

  if(pos>1999) {
    pos=0;
    if(halloweenmode&&!green_on){
      green_on=true;
    }else{
      green_on=false;
    }
    if(halloweenmode) delay(3000);
  }
    
}
